<html>
<head>
<script type="text/javascript" src="js/jquery/js/jquery-1.6.2.min.js"></script>
<script>
var websocket;

$(document).ready( function(){
                
     //   netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
       //         var file = Components.classes["@mozilla.org/file/local;1"].
         //  createInstance(Components.interfaces.nsILocalFile);
                
        websocket = new MozWebSocket("ws://127.0.0.1:10004/~gary/arduino/Arduino-Connect/web/");
                websocket.onopen = function(evt){
                    // alert("opened");
                     ///websocket.send("x");
                };
                websocket.onerror= function( evt ){
                     alert("web socket connection error");
                };
                websocket.onclose = function( evt ){
                     alert( "web socket closed");
                };     
                    
                websocket.onmessage = function( evt ){
                 var tmp = JSON.parse( evt.data );
                 
                $('#messageArea').html( "Pin: " + tmp.pin + " Value: " + tmp.value);      
                //  $('#messageArea').html( "<p>hello</p>");      
                };
                     
       $('#sendButton').click( function(){
            var msg= $('#data').val();
            msg = $.trim( msg );
            websocket.send( msg );
                       
       });
       
       $('#scriptButton').click( function(){
          var scriptContents = $('#scriptText').val();
          scriptContents = $.trim( scriptContents );
          scriptContents = "<script>"+scriptContents+'<\/script>';
          websocket.send( scriptContents);
                       
       });
     
});





</script>
</head>


<body>

<input type="text" id="data" value="type some data here">
<button id="sendButton">Send</button>
<div id="messageArea">


</div>

<div id="scriptArea" >
<textarea id="scriptText"cols="100" rows="40" >
enter script here

</textarea>
<br />
<button id="scriptButton">Upload Script</script>
</div>
</body>



</html>
